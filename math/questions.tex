\documentclass[12pt]{article}

\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amsthm,amssymb}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage{mathtools}
\usepackage{float}
\usepackage{etoolbox}\AtBeginEnvironment{algorithmic}{\small}

%\setlength{\parindent}{4em}

\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Tr}{\mathrm{Tr}}
\newcommand{\one}{\mathbf{1}}
\DeclareMathOperator*{\argmax}{arg\,max} 
\DeclareMathOperator*{\argmin}{arg\,min}


\newenvironment{theorem}[2][Theorem]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{lemma}[2][Lemma]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{problem}[2][Problem]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{reflection}[2][Reflection]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{proposition}[2][Proposition]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{corollary}[2][Corollary]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}

\algnewcommand{\IfThenElse}[3]{\State \algorithmicif\ #1\ \algorithmicthen\ #2\ \algorithmicelse\ #3}

\begin{document}


\title{Pre-interview Task}
\author{William Maxwell} 
\maketitle
\paragraph{Problem 1a.}
The equivalence between minimizing $K$-means and maximizing intra-cluster kernel similarity was shown by Ding, He, and Simon~\cite{Ding2005}. 
We follow their approach. Let $C_1,\dots,C_K$ be the clusters found by $K$-means and $c_1,\dots,c_K$ be their centroids. That is, $c_k = \sum_{i \in C_k} x_i/|C_k|$. We start by rewriting the $K$-means objective function as a sum of inner products.
\begin{align*}
J_{k\text{-means}} &= \sum_{k=1}^K \sum_{i \in C_k} \|x_i - c_k\|^2\\
 &= \sum_{k=1}^K \sum_{i \in C_k} \|x_i\|^2 + \|c_k\|^2 - 2x_i^T c_k \\
&= \sum_{i=1}^n \|x_i\|^2 + \sum_{k=1}^K \sum_{i \in C_k} \|c_k\|^2 - 2 \sum_{k=1}^K \sum_{i \in C_k} x_i^T c_k \\
&= \sum_{i=1}^n \|x_i\|^2 + \sum_{k=1}^K |C_k| \|c_k\|^2 - 2 \sum_{k=1}^K |C_k| \|c_k\|^2 \\
&= \sum_{i=1}^n \|x_i\|^2 - \sum_{k=1}^K |C_k|\|c_k\|^2\\
&= \sum_{i=1}^n \|x_i\|^2 - \sum_{k=1}^K \frac{1}{|C_k|} \sum_{i, j \in C_k} x_i^T x_j
\end{align*}
Since $\sum_{i=1}^n \|x_i\|^2$ is a constant, $J_{K\text{-means}}$ is minimized when $\sum_{k=1}^K \frac{1}{|C_k|} \sum_{i, j \in C_k} x_i^T x_j$ is maximized. Let $H$ be an indicator matrix for the clusters returned by $K$-means. We compute the entries of $HAH^T$ where $A=X^TX$, \[(HAH^T)_{ij} =  \frac{1}{\sqrt{C_i C_j}} \sum_{x \in C_i}\sum_{y \in C_j} x^T y. \] Hence, on the diagonal we have \[(HAH^T)_{ii} =  \frac{1}{|C_k|} \sum_{i, j \in C_k} x_i^T x_j, \] from which it follows that \[ \Tr(HAH^T) = \sum_{k=1}^K \frac{1}{|C_k|} \sum_{i, j \in C_k} x_i^T x_j.\]
Thus, we conclude $\argmin_{H} J_{K\text{-means}} = \argmax_H \Tr(HAH^T)$ where $H$ ranges over all orthogonal indicator matrices.

\paragraph{Problem 1b.}
Now, we can show that $K$-means can be formulated as an NNMF problem under the constraints that $H$ is an orthogonal indicator matrix and $W = H^T$.
\begin{align*}
\argmin_{H} J_{k\text{-means}} &= \argmax_H \Tr(HAH^T) \\
&= \argmin_H -2\Tr(HAH^T) \\
&= \argmin_H \|A\|^2 -2 \Tr(HAH^T) + \|H^TH\|^2 \\
&= \argmin_H \|A - HH^T\|^2
\end{align*}

\paragraph{Problem 2a.}
Use citation \cite{Ding2008}
\paragraph{Problem 2b.}
\paragraph{Problem 2c.}

\bibliographystyle{plain}
\bibliography{questions}

\end{document}

